---
layout: post
title: "Pete: An Origin Story"
date: 2018-05-26 09:00:00
summary: Why I wrote, the things I learned and how I grew as a developer writing an automated media fetching program called Pete.
categories: development, pete
---

This is about the reasons for writing and the things I learned from making [Pete](https://github.com/grantholle/pete), something of which I'm personally very proud.

My wife and I are big movie and TV fans. We were long-time subscribers to Netflix before moving to China, and even for a while afterwards. Netflix isn't supported in China, but with a VPN we could access other countries' content. It was seriously awesome. I had no idea the content was different for other countries. We were watching _Fresh Prince_ from Canada. I mean... how cool is that.

Then in early 2016 they flexed their technical muscles and managed to block users who were using a VPN connection. There's a great WIRED [article](https://www.wired.com/2016/03/netflix-discontent-blocked-vpns-boiling/) that echoes exactly how I felt at the time. I came to understand that it was Netflix's idea to do this, but it was the studios and content providers who were making them do it. The ending quote really captured my mindset:

>“Piracy is made by the greed of the entertainment industry and stockholders,” he adds. “I am a normal man willing to pay for content and they are making that almost impossible."

I am no stranger to torrenting, but with a service like Netflix, I didn't have to do it. Until now.

There are a lot of Chinese video sites that offer English movies and TV shows, but the ads are InSaNe and the content sometimes gets censored. And the ads... seriously are freaking nuts. I can't stand it.

I had a Raspberry Pi 1 laying around. I installed a fresh version of Raspbian, Transmission, added USB harddrive I had and we were in business. I figured out how to play stuff using SSH as a [awful] remote system to a very rudimentary media center.

I was just adding stuff by hand, and it sucked. I knew other people probably had the same desire : automate this crap. So the search began. Like most people, I learned about a [CouchPotato](https://couchpota.to/) and [FlexGet](https://www.flexget.com/) setup. Both projects had a ton of support and had been around a while, so I gave it a shot. There were a lot of guides to get it set up, but I was _never_ successful at getting something going.

About the same time, I realized that running Raspbian and running a command using SSH any time I wanted to watch something was just as sustainable as me searching for shows and movies by hand. I learned about [Kodi](https://kodi.tv/), and then I needed something that could run on an old Pi. Then I found [OSMC](https://osmc.tv/), which had a great UI and were making it their full-time job to support and develop for it, which was super cool. The main developer [Sam Nazarko](http://samnazarko.co.uk/) is super great at supporting OSMC and is doing a great job at improving it. On top of that, there's a great remote app for your phone called [Yatse](https://yatse.tv/) that made controlling it so easy. **Now** we were really cooking.

But for the life of me, I could not get the CouchPotato/FlexGet setup working. It would kind of work, but I couldn't tell what it was actually doing and seemed like a black box. It was working and I couldn't understand why. FlexGet is _so_ flexible... _too_ flexible for me. I couldn't configure it. I had found other people's "recipes" which supposedly worked for them, but didn't for me. I needed something a little less work, a little more opinionated. That developer itch really needed to be scratched, and what a project to undertake.

I reached for the scripting language I was most familiar with and easy to install and run: Node. I decided I wanted to set up the movies and shows "in the cloud" then the script would just find those things, so I went with [TMDb](https://www.themoviedb.org/). It's a community-driven source of info on movies and TV, much like IMDB, just cleaner and easier to use.

My plan was to add stuff to my watchlists on there, and my script would pull that stuff, search for the movies and new TV episodes. Sounded simple enough...

I love 30 Rock and the character Pete was always funny to me. Behind the scenes, but always got work down. Just what I needed, a Pete.

What followed was months of learning, growing and contributing:

- I really got to learn Node's asynchronous nature
  - I was able to refactor the Promises using `async/await` later, also learning how they work
- I contributed to or hard-forked libraries that I used by adding Promise support. Some weren't merging PR's, some didn't want to add the support
  - [node-pushbullet-api](https://github.com/alexwhitman/node-pushbullet-api)
  - [moviedb-promise](https://github.com/grantholle/moviedb-promise), [original](https://github.com/impronunciable/moviedb)
  - [transmission-promise](https://github.com/grantholle/transmission), [original](https://github.com/FLYBYME/node-transmission)
- I got to integrate several API's and even write my own libraries for
  - [rarbg](https://github.com/grantholle/rarbg) - by far the most reliable torrent search engine api
  - [eztv](https://github.com/grantholle/eztv) - previously only could be a scraper, now they have a beta api. I also find their website a pain to use so this was a win-win
- I learned how to [sync a fork](https://help.github.com/articles/syncing-a-fork/) with the original repo
- I got to learn more about how the BitTorrent protocol works

The end result is something I am really proud of. It doesn't take much configuration to have Pete fetching the movies and shows you want to watch automatically.

I originally wrote it specifically to play nice with Kodi, and then generalized it when I graduated to my own [Plex](https://plex.tv) server. It's still opinionated (Transmission, TMDb, rarbg and eztv) but I feel like that's ok, because at the end of the day, I just want my content. I've chosen the most reliable way to get it as seamlessly and easy as possible. Give it a whirl and let me know what you think.